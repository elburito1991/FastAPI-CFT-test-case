# Python FastAPI, CFT test-case
---

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ elburito1991@gmail.com

–ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞—á–∏ REST-—Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–µ–∫—É—â–µ–π –∑–∞—Ä–ø–ª–∞—Ç—ã –∏ –¥–∞—Ç—ã —Å–ª–µ–¥—É—é—â–µ–≥–æ
–ø–æ–≤—ã—à–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑—É—è —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ `FastAPI`.

–í –ø—Ä–æ–≥—Ä–∞–º–º–µ –≤—ã–¥–µ–ª–µ–Ω–æ –¥–≤–µ —Ä–æ–ª–∏:
1. –ë–∞–∑–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –Ω–µ –æ–±–ª–∞–¥–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏,
–∏ –º–æ–∂–µ—Ç –ª–∏—à—å –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ—é (–∏ —Ç–æ–ª—å–∫–æ —Å–≤–æ—é) —Ç–µ–∫—É—â—É—é –∑/–ø, —Å—É–º–º—É –∏ –¥–∞—Ç—É —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ–≤—ã—à–µ–Ω–∏—è.
2. –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä —Å–µ—Ä–≤–∏—Å–∞: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞—Ä–ø–ª–∞—Ç—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É
(—Ä–∞—Å—á–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π –¥–∞—Ç—ã –∏ —Å—É–º–º—ã –∑/–ø –ø–æ—Å–ª–µ –ø–æ–≤—ã—à–µ–Ω–∏—è —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏), –∏–º–µ–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∑/–ø,
–∏, –Ω–∞–∫–æ–Ω–µ—Ü, –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å –æ–±–æ–∑–Ω–∞—á–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –Ω–µ –º–æ–∂–µ—Ç –∫–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞–∫—É—é-–ª–∏–±–æ –∑/–ø 
—Å–µ–±–µ, —Ç–∞–∫ –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –µ–µ.

### Python
–í –ø—Ä–æ–≥—Ä–∞–º–º–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ—Ä—Å–∏—è Python 3.10.5.

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `FastAPI Users`.<br>
–í—ã–±—Ä–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:
1. `JWTStrategy`
2. `CookieTransport`

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ –≤ —Ñ–∞–π–ª–∞—Ö Cookies
–∏ –µ–≥–æ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ —Å–∏—Å—Ç–µ–º–µ.

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–¥ `PostgreSQL`


### üñ• –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: `git clone <this repo's remote url>`
2. –ó–∞–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é: `cd <–Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏>`
3. –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:
```
python -m venv venv
```
–ó–∞—Ç–µ–º –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –µ–≥–æ
- –î–ª—è Windows –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É: `venv\Scripts\activate`
- –î–ª—è Linux —Å–∏—Å—Ç–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É: source `'venv/bin/activate'`
4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≤–µ—Ä—Å–∏—é [Python](#Python)):<br> 
`pip install -r requirements.txt`
5. –°–æ–∑–¥–∞–π—Ç–µ 2 –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL(—Ä–∞–±–æ—á—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é), –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –ø–æ–º–æ—â–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è [pgAdmin](https://www.pgadmin.org/download/)
6. –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–π—Ç–µ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–∞–π–ª —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã - `.env`. 
–ü—Ä–∏–º–µ—Ä –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –¥–æ–ø. –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `env-example.txt` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
7. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü –≤ –ë–î –∫–æ–º–∞–Ω–¥–æ–π:
```
alembic upgrade head   
```
8. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –î–ª—è –∑–∞–ø—É—Å–∫–∞ FastAPI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä uvicorn. –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
```
uvicorn app.main:app --reload      
```
–ï–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞—Ö–æ–¥—è—Å—å –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.
–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≤—ã —É–≤–∏–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –∏–ª–∏ —Å—Å—ã–ª–∫—É –≤ –ø–æ–ª–µ (Uvicorn running on ...) –≥–¥–µ –∑–∞–ø—É—â–µ–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. 
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ/–∞–¥—Ä–µ—Å—É  –∏ –¥–æ–ø–∏—à–∏—Ç–µ –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞ `/docs` - –≤—ã —É–≤–∏–¥–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é API 
–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —Å –∫–æ—Ç–æ—Ä–æ–π –º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å. 
–ß—Ç–æ–±—ã —Ä–∞–∑–æ—Ä–≤–∞—Ç—å —Å–µ–∞–Ω—Å –Ω–∞—Ö–æ–¥—è—Å—å –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –Ω–∞–∂–º–∏—Ç–µ —Å–æ—á–µ—Ç–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ ctrl+c. <br>
<br>–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤ –ø–æ–ª–µ –ª–æ–≥–∏–Ω –ø—Ä–æ–ø–∏—à–∏—Ç–µ
–∑–Ω–∞—á–µ–Ω–∏–µ "admin" (–ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–∏—Å–≤–æ–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é su(Super user) = True)


### üîß –ë–ª–æ–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã –ø—Ä–∏ –ø–æ–º–æ—â–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `Pytest`<br>
–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ –Ω–∞—Ö–æ–¥—è—Å—å –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:<br>
```
pytest -v
```
